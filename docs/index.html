<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>LINEログイン</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <h2>ログイン中です...</h2>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbx5Jy2t_fXXbtJZ0KgrmYAY7uJI7v-Etau9QkrgN-XPAd1i3G_a5d4BTXfpK9TOLEgY/exec";

    async function main() {
      await liff.init({ liffId: "2007626441-bRzd722l" });  // あなたのLIFF ID
      if (!liff.isLoggedIn()) {
        liff.login();
        return;
      }

      const profile = await liff.getProfile();
      const userId = encodeURIComponent(profile.userId);

      // 会員チェックAPIへ問い合わせ
      try {
        const res = await fetch(`${GAS_URL}?userId=${userId}`);
        const result = await res.json();

        if (result.isMember) {
          location.href = "menber.html";  // 会員の場合
        } else {
          location.href = "notmenber.html";  // 非会員の場合
        }
      } catch (error) {
        console.error("API error:", error);
        alert("エラーが発生しました。時間をおいて再度お試しください。");
      }
    }

    main();
  </script>
</body>
</html>
